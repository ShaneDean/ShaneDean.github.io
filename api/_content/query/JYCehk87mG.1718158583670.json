{"_path":"/blog/ovirt/engine/development_environment","_dir":"engine","_draft":false,"_partial":false,"_locale":"","title":"oVirt Engine 开发环境搭建","description":"","body":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"ovirt-engine-开发环境搭建"},"children":[{"type":"text","value":"oVirt Engine 开发环境搭建"}]},{"type":"element","tag":"h2","props":{"id":"基础环境"},"children":[{"type":"text","value":"基础环境"}]},{"type":"element","tag":"h3","props":{"id":"安装centos7"},"children":[{"type":"text","value":"安装Centos7"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"image","src":"https://github.com/ShaneDean/file/blob/master/blog/ovirt_engine_env/version.png?raw=true"},"children":[]}]},{"type":"element","tag":"h3","props":{"id":"安装jdk"},"children":[{"type":"text","value":"安装jdk"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"下载最新"},{"type":"element","tag":"a","props":{"href":"http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html/","rel":["nofollow"]},"children":[{"type":"text","value":"jdk8"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"选择jdk-xxxx-linux-x64.rpm版本"}]},{"type":"element","tag":"pre","props":{"code":"sudo rpm -ivh jdk-xxxx-linux-x64.rpm\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"sudo rpm -ivh jdk-xxxx-linux-x64.rpm\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"修改JAVA环境变量"}]},{"type":"element","tag":"pre","props":{"code":"vim /etc/profile\n\n//在最后加上，然后wq!\nexport JAVA_HOME=/usr/java/jdk1.8.0_144\nexport CLASSPATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar\nexport PATH=$PATH:$JAVA_HOME/bin\n\n//启用配置\nsource /etc/profile\n\n//此时替换掉原有的centos7 java版本 选择你下载的版本\nsudo alternatives --config java\n\n//最后\njava -version\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"vim /etc/profile\n\n//在最后加上，然后wq!\nexport JAVA_HOME=/usr/java/jdk1.8.0_144\nexport CLASSPATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar\nexport PATH=$PATH:$JAVA_HOME/bin\n\n//启用配置\nsource /etc/profile\n\n//此时替换掉原有的centos7 java版本 选择你下载的版本\nsudo alternatives --config java\n\n//最后\njava -version\n"}]}]},{"type":"element","tag":"h3","props":{"id":"配置maven350"},"children":[{"type":"text","value":"配置maven3.5.0"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"a","props":{"href":"http://www.cnblogs.com/HendSame-JMZ/p/6122188.html","rel":["nofollow"]},"children":[{"type":"text","value":"参考"}]}]},{"type":"element","tag":"h3","props":{"id":"安装git"},"children":[{"type":"text","value":"安装git"}]},{"type":"element","tag":"pre","props":{"code":"sudo yum install git\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"sudo yum install git\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"速度太慢 替换使用阿里源 "},{"type":"element","tag":"a","props":{"href":"http://mirrors.aliyun.com/help/centos","rel":["nofollow"]},"children":[{"type":"text","value":"参考"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"ht内部源"},{"type":"element","tag":"a","props":{"href":"http://mirrors.ht.com/repo/help/centos.html","rel":["nofollow"]},"children":[{"type":"text","value":"参考"}]}]},{"type":"element","tag":"h3","props":{"id":"克隆代码"},"children":[{"type":"text","value":"克隆代码"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"代码仓库有2个可选\n一个是"},{"type":"element","tag":"a","props":{"href":"https://github.com/oVirt/ovirt-engine","rel":["nofollow"]},"children":[{"type":"text","value":"github"}]},{"type":"text","value":"，另一个是ovirt项目开发用的"},{"type":"element","tag":"a","props":{"href":"https://gerrit.ovirt.org/#/admin/projects/ovirt-engine","rel":["nofollow"]},"children":[{"type":"text","value":"gerrit"}]}]},{"type":"element","tag":"pre","props":{"code":"cd /the/path/you/want/\ngit clone https://github.com/oVirt/ovirt-engine.git\ncd ovirt-engine\n//切换分支，我们这里使用ovirt-engine-4.0\ngit branch -a  //查看全部分支\ngit checkout -t origin/ovirt-engine-4.0 //切换分支\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"cd /the/path/you/want/\ngit clone https://github.com/oVirt/ovirt-engine.git\ncd ovirt-engine\n//切换分支，我们这里使用ovirt-engine-4.0\ngit branch -a  //查看全部分支\ngit checkout -t origin/ovirt-engine-4.0 //切换分支\n"}]}]},{"type":"element","tag":"h3","props":{"id":"导入项目"},"children":[{"type":"text","value":"导入项目"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"下载安装intellij idea安装；完成后打开。"}]},{"type":"element","tag":"pre","props":{"code":"Import Project -> \n    选择克隆代码路径 -> \nimport project from external model ->\n    选择<maven> ->\nEnvironment settings... ->\n    选择3.5.0的MAVEN_HOME->\n    选择Override ->\n->next ... \n->选择新的jdk \n->next ...\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"Import Project -> \n    选择克隆代码路径 -> \nimport project from external model ->\n    选择<maven> ->\nEnvironment settings... ->\n    选择3.5.0的MAVEN_HOME->\n    选择Override ->\n->next ... \n->选择新的jdk \n->next ...\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"全部完成后ide会自动去下载依赖"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"觉得国外下载速度慢可以"},{"type":"element","tag":"a","props":{"href":"http://blog.csdn.net/u010717403/article/details/52188496","rel":["nofollow"]},"children":[{"type":"text","value":"参考"}]},{"type":"text","value":"替换成阿里源或者内部的源"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"依赖导入完成后就可以阅读代码了"}]},{"type":"element","tag":"h2","props":{"id":"开发环境"},"children":[{"type":"text","value":"开发环境"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"阅读代码的下一步就是把项目跑起来"}]},{"type":"element","tag":"h3","props":{"id":"编译"},"children":[{"type":"text","value":"编译"}]},{"type":"element","tag":"pre","props":{"code":"//关闭单元测试，不然时间太久\nmake install-dev PREFIX=\"/the/path/you/want/\" BUILD_UT=0\n\n//建议时间戳来设置不同的安装目录，不然清理和重新配置的过程会有很多麻烦\n//第一次时间还是会比较久，因为会有一些临时下载的包\n//存在因为网络原因导致失败的情况，请耐心等待\n\n...\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"//关闭单元测试，不然时间太久\nmake install-dev PREFIX=\"/the/path/you/want/\" BUILD_UT=0\n\n//建议时间戳来设置不同的安装目录，不然清理和重新配置的过程会有很多麻烦\n//第一次时间还是会比较久，因为会有一些临时下载的包\n//存在因为网络原因导致失败的情况，请耐心等待\n\n...\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"编译的时候我们可以先去做其他事情"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"成功的效果：\n"},{"type":"element","tag":"img","props":{"alt":"image","src":"https://github.com/ShaneDean/file/blob/master/blog/ovirt_engine_env/make_install_dev.png?raw=true"},"children":[]}]},{"type":"element","tag":"h3","props":{"id":"依赖服务"},"children":[{"type":"text","value":"依赖服务"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"参考ovirt-engine的readme文件"}]},{"type":"element","tag":"pre","props":{"code":"- jdk-8 / openjdk-8-jdk / icedtea-8\n- mime-types or mailcap\n- unzip\n- openssl\n- postgresql-server postgresql\n- python-m2crypto / m2crypto\n- python-psycopg2 / psycopg\n- python-jinja2 / Jinja2\n- libxml2-python / libxml2[python]\n- python-daemon\n- otopi >= 1.1.0\n- ovirt-host-deploy >= 1.1.0\n- ovirt-setup-lib\n- maven-3 (optional)\n- pyflakes (optional)\n- python-pep8 / pep8 (optional)\n- patternfly1 (optional)\n- python-docker-py (optional)\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"- jdk-8 / openjdk-8-jdk / icedtea-8\n- mime-types or mailcap\n- unzip\n- openssl\n- postgresql-server postgresql\n- python-m2crypto / m2crypto\n- python-psycopg2 / psycopg\n- python-jinja2 / Jinja2\n- libxml2-python / libxml2[python]\n- python-daemon\n- otopi >= 1.1.0\n- ovirt-host-deploy >= 1.1.0\n- ovirt-setup-lib\n- maven-3 (optional)\n- pyflakes (optional)\n- python-pep8 / pep8 (optional)\n- patternfly1 (optional)\n- python-docker-py (optional)\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"首先"}]},{"type":"element","tag":"pre","props":{"code":"sudo yum install http://plain.resources.ovirt.org/pub/yum-repo/ovirt-release40.rpm\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"sudo yum install http://plain.resources.ovirt.org/pub/yum-repo/ovirt-release40.rpm\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"然后执行"}]},{"type":"element","tag":"pre","props":{"code":"sudo yum install mailcap unzip m2crypto python-psycopg2 python-jinja2 libxml2-python python-daemon otopi ovirt-host-deploy ovirt-setup-lib postgresql-server ovirt-engine-wildfly ovirt-engine-wildfly-overlay patternfly1 pyflakes\n\n\n//\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"sudo yum install mailcap unzip m2crypto python-psycopg2 python-jinja2 libxml2-python python-daemon otopi ovirt-host-deploy ovirt-setup-lib postgresql-server ovirt-engine-wildfly ovirt-engine-wildfly-overlay patternfly1 pyflakes\n\n\n//\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"找不到的包去"},{"type":"element","tag":"a","props":{"href":"https://rpmfind.net/","rel":["nofollow"]},"children":[{"type":"text","value":"rpmfind"}]},{"type":"text","value":"里面去下"}]},{"type":"element","tag":"h4","props":{"id":"配置postgresql"},"children":[{"type":"text","value":"配置postgresql"}]},{"type":"element","tag":"pre","props":{"code":"sudo -i\ncd /var/lib/pgsql/data\npostgresql-setup initdb\nvim pg_hba.conf  #增加允许的IP\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"sudo -i\ncd /var/lib/pgsql/data\npostgresql-setup initdb\nvim pg_hba.conf  #增加允许的IP\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"image","src":"https://github.com/ShaneDean/file/blob/master/blog/ovirt_engine_env/postgresql1.png?raw=true"},"children":[]}]},{"type":"element","tag":"pre","props":{"code":"vim postgresql.conf \n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"vim postgresql.conf \n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"image","src":"https://github.com/ShaneDean/file/blob/master/blog/ovirt_engine_env/postgresql2.png?raw=true"},"children":[]}]},{"type":"element","tag":"h4","props":{"id":"增加数据库用户"},"children":[{"type":"text","value":"增加数据库用户"}]},{"type":"element","tag":"pre","props":{"code":"systemctl restart postgresql.service\n\nsu postgres\n\npsql\n\n#create user\ncreate user engine password 'engine';\n#create database\ncreate database engine owner engine template template0 encoding 'UTF8' lc_collate 'en_US.UTF-8' lc_ctype 'en_US.UTF-8';\n#exit\n\\q  \n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"systemctl restart postgresql.service\n\nsu postgres\n\npsql\n\n#create user\ncreate user engine password 'engine';\n#create database\ncreate database engine owner engine template template0 encoding 'UTF8' lc_collate 'en_US.UTF-8' lc_ctype 'en_US.UTF-8';\n#exit\n\\q  \n"}]}]},{"type":"element","tag":"h4","props":{"id":"增加jboss环境"},"children":[{"type":"text","value":"增加jboss环境"}]},{"type":"element","tag":"pre","props":{"code":"sudo vim /etc/profile\n\n#增加一段    \nexport JBOSS_HOME=/usr/share/ovirt-engine-wildfly\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"sudo vim /etc/profile\n\n#增加一段    \nexport JBOSS_HOME=/usr/share/ovirt-engine-wildfly\n"}]}]},{"type":"element","tag":"h3","props":{"id":"engine-服务启动"},"children":[{"type":"text","value":"engine 服务启动"}]},{"type":"element","tag":"h4","props":{"id":"engine-setup"},"children":[{"type":"text","value":"engine-setup"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"在编译完成后，如果是第一次启动服务我们需要调用ovirt提供的setup脚步来配置初始化服务"}]},{"type":"element","tag":"pre","props":{"code":"cd /the/path/you/make/install-dev/\n\n./bin/engine-setup\n\n#后面根据个人需求配置\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"cd /the/path/you/make/install-dev/\n\n./bin/engine-setup\n\n#后面根据个人需求配置\n"}]}]},{"type":"element","tag":"h4","props":{"id":"start"},"children":[{"type":"text","value":"start"}]},{"type":"element","tag":"pre","props":{"code":"./share/ovirt-engine/services/ovirt-engine/ovirt-engine.py start\n\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"./share/ovirt-engine/services/ovirt-engine/ovirt-engine.py start\n\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"访问  ++"},{"type":"element","tag":"a","props":{"href":"http://127.0.0.1:8080/ovirt-engine/++","rel":["nofollow"]},"children":[{"type":"text","value":"http://127.0.0.1:8080/ovirt-engine/++"}]}]},{"type":"element","tag":"h4","props":{"id":"可能出现的错误的解决办法"},"children":[{"type":"text","value":"可能出现的错误的解决办法"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"a","props":{"href":"http://blog.csdn.net/wangjun_pfc/article/details/5528893","rel":["nofollow"]},"children":[{"type":"text","value":"错误1"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"登录效果"},{"type":"element","tag":"img","props":{"alt":"image","src":"https://github.com/ShaneDean/file/blob/master/blog/ovirt_engine_env/webadmin1.png?raw=true"},"children":[]}]},{"type":"element","tag":"h2","props":{"id":"调试环境"},"children":[{"type":"text","value":"调试环境"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"服务起来后的下一步就是启用调试环境，可以断点调试"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"基础环境","depth":2,"text":"基础环境","children":[{"id":"安装centos7","depth":3,"text":"安装Centos7"},{"id":"安装jdk","depth":3,"text":"安装jdk"},{"id":"配置maven350","depth":3,"text":"配置maven3.5.0"},{"id":"安装git","depth":3,"text":"安装git"},{"id":"克隆代码","depth":3,"text":"克隆代码"},{"id":"导入项目","depth":3,"text":"导入项目"}]},{"id":"开发环境","depth":2,"text":"开发环境","children":[{"id":"编译","depth":3,"text":"编译"},{"id":"依赖服务","depth":3,"text":"依赖服务"},{"id":"engine-服务启动","depth":3,"text":"engine 服务启动"}]},{"id":"调试环境","depth":2,"text":"调试环境"}]}},"_type":"markdown","_id":"content:blog:ovirt:engine:development_environment.md","_source":"content","_file":"blog/ovirt/engine/development_environment.md","_extension":"md"}